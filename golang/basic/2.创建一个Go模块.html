<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>创建一个Go模块 | Hzml Code-Book</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script src="https://www.googletagmanager.com/gtag/js?id=G-175K59GC1N" async="true"></script>
    <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            
            gtag('config', 'G-175K59GC1N');
        </script>
    <meta name="description" content="Hzml Code-Book">
    
    <link rel="preload" href="/docs/assets/css/0.styles.eb47bffd.css" as="style"><link rel="preload" href="/docs/assets/js/app.01c93764.js" as="script"><link rel="preload" href="/docs/assets/js/2.2d8514e9.js" as="script"><link rel="preload" href="/docs/assets/js/14.0d56bfa0.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.c7c6a8e3.js"><link rel="prefetch" href="/docs/assets/js/11.c9661a93.js"><link rel="prefetch" href="/docs/assets/js/12.1279196e.js"><link rel="prefetch" href="/docs/assets/js/13.11f069e8.js"><link rel="prefetch" href="/docs/assets/js/15.9c25e017.js"><link rel="prefetch" href="/docs/assets/js/16.b63ae8c6.js"><link rel="prefetch" href="/docs/assets/js/17.3317484b.js"><link rel="prefetch" href="/docs/assets/js/18.fb44ae63.js"><link rel="prefetch" href="/docs/assets/js/19.1a384a56.js"><link rel="prefetch" href="/docs/assets/js/20.c3fd2403.js"><link rel="prefetch" href="/docs/assets/js/21.0f8d82c2.js"><link rel="prefetch" href="/docs/assets/js/22.997f814b.js"><link rel="prefetch" href="/docs/assets/js/23.e99fc4fb.js"><link rel="prefetch" href="/docs/assets/js/24.a5ea8694.js"><link rel="prefetch" href="/docs/assets/js/25.ae0fe913.js"><link rel="prefetch" href="/docs/assets/js/26.b41fd34b.js"><link rel="prefetch" href="/docs/assets/js/27.4170579d.js"><link rel="prefetch" href="/docs/assets/js/28.dc7c028a.js"><link rel="prefetch" href="/docs/assets/js/29.d5feefd1.js"><link rel="prefetch" href="/docs/assets/js/3.753f60e9.js"><link rel="prefetch" href="/docs/assets/js/30.e4c0c578.js"><link rel="prefetch" href="/docs/assets/js/31.8bda91a8.js"><link rel="prefetch" href="/docs/assets/js/32.fe9e4af2.js"><link rel="prefetch" href="/docs/assets/js/33.09d9b618.js"><link rel="prefetch" href="/docs/assets/js/34.09710b5d.js"><link rel="prefetch" href="/docs/assets/js/35.69f8dd63.js"><link rel="prefetch" href="/docs/assets/js/36.aca157ec.js"><link rel="prefetch" href="/docs/assets/js/37.e5d95f02.js"><link rel="prefetch" href="/docs/assets/js/38.555a01b0.js"><link rel="prefetch" href="/docs/assets/js/39.2319303e.js"><link rel="prefetch" href="/docs/assets/js/4.f1b90a9c.js"><link rel="prefetch" href="/docs/assets/js/40.85dca416.js"><link rel="prefetch" href="/docs/assets/js/41.61fd7ba1.js"><link rel="prefetch" href="/docs/assets/js/42.4af52951.js"><link rel="prefetch" href="/docs/assets/js/43.9aac0ca7.js"><link rel="prefetch" href="/docs/assets/js/44.9b8ef825.js"><link rel="prefetch" href="/docs/assets/js/45.22cab614.js"><link rel="prefetch" href="/docs/assets/js/46.08dbd14c.js"><link rel="prefetch" href="/docs/assets/js/47.48699451.js"><link rel="prefetch" href="/docs/assets/js/48.feea7b15.js"><link rel="prefetch" href="/docs/assets/js/49.d1ec5f48.js"><link rel="prefetch" href="/docs/assets/js/5.bb2e5f53.js"><link rel="prefetch" href="/docs/assets/js/50.c21b0937.js"><link rel="prefetch" href="/docs/assets/js/51.0141d889.js"><link rel="prefetch" href="/docs/assets/js/52.e568693e.js"><link rel="prefetch" href="/docs/assets/js/53.53560722.js"><link rel="prefetch" href="/docs/assets/js/54.4288714a.js"><link rel="prefetch" href="/docs/assets/js/55.0b53a78d.js"><link rel="prefetch" href="/docs/assets/js/56.7d19e1b0.js"><link rel="prefetch" href="/docs/assets/js/57.7fdd16ce.js"><link rel="prefetch" href="/docs/assets/js/58.edaac107.js"><link rel="prefetch" href="/docs/assets/js/59.47e1e5cb.js"><link rel="prefetch" href="/docs/assets/js/6.7551a3ec.js"><link rel="prefetch" href="/docs/assets/js/60.74ea52f6.js"><link rel="prefetch" href="/docs/assets/js/61.df7f149d.js"><link rel="prefetch" href="/docs/assets/js/62.4772ede3.js"><link rel="prefetch" href="/docs/assets/js/63.9718cdf7.js"><link rel="prefetch" href="/docs/assets/js/64.4d5b14c0.js"><link rel="prefetch" href="/docs/assets/js/65.5282e75c.js"><link rel="prefetch" href="/docs/assets/js/66.03ae7250.js"><link rel="prefetch" href="/docs/assets/js/67.bd2b90aa.js"><link rel="prefetch" href="/docs/assets/js/68.72a19020.js"><link rel="prefetch" href="/docs/assets/js/69.70040cf3.js"><link rel="prefetch" href="/docs/assets/js/7.1806fdef.js"><link rel="prefetch" href="/docs/assets/js/70.1e42849e.js"><link rel="prefetch" href="/docs/assets/js/71.e8ee8410.js"><link rel="prefetch" href="/docs/assets/js/72.32f433ac.js"><link rel="prefetch" href="/docs/assets/js/73.4ec9d601.js"><link rel="prefetch" href="/docs/assets/js/74.38324d55.js"><link rel="prefetch" href="/docs/assets/js/75.15903373.js"><link rel="prefetch" href="/docs/assets/js/76.b6697f6e.js"><link rel="prefetch" href="/docs/assets/js/77.c4aa7c7b.js"><link rel="prefetch" href="/docs/assets/js/78.841456b3.js"><link rel="prefetch" href="/docs/assets/js/79.791f25d3.js"><link rel="prefetch" href="/docs/assets/js/8.22845c8b.js"><link rel="prefetch" href="/docs/assets/js/80.ce938d83.js"><link rel="prefetch" href="/docs/assets/js/81.b10aa5d1.js"><link rel="prefetch" href="/docs/assets/js/82.ec26ddfd.js"><link rel="prefetch" href="/docs/assets/js/83.042ed5eb.js"><link rel="prefetch" href="/docs/assets/js/84.074c359f.js"><link rel="prefetch" href="/docs/assets/js/85.9cfca185.js"><link rel="prefetch" href="/docs/assets/js/86.e9cf185b.js"><link rel="prefetch" href="/docs/assets/js/87.40c63c75.js"><link rel="prefetch" href="/docs/assets/js/88.431ecc87.js"><link rel="prefetch" href="/docs/assets/js/89.4010e2df.js"><link rel="prefetch" href="/docs/assets/js/9.c2a53714.js"><link rel="prefetch" href="/docs/assets/js/90.483bdbb7.js"><link rel="prefetch" href="/docs/assets/js/91.9dfaad08.js"><link rel="prefetch" href="/docs/assets/js/92.21001a7d.js"><link rel="prefetch" href="/docs/assets/js/93.f14a89f0.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.eb47bffd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="logo.webp" alt="Hzml Code-Book" class="logo"> <span class="site-name can-hide">Hzml Code-Book</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GoLang相关" class="dropdown-title"><span class="title">GoLang相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="GoLang相关" class="mobile-dropdown-title"><span class="title">GoLang相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/golang/basic/" class="nav-link router-link-active">
  GoLang基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java相关" class="dropdown-title"><span class="title">Java相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java相关" class="mobile-dropdown-title"><span class="title">Java相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/java/basic/" class="nav-link">
  Java基础
</a></li><li class="dropdown-item"><!----> <a href="/docs/java/jvm/" class="nav-link">
  JVM
</a></li><li class="dropdown-item"><!----> <a href="/docs/java/spring/" class="nav-link">
  Spring相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript相关" class="dropdown-title"><span class="title">JavaScript相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript相关" class="mobile-dropdown-title"><span class="title">JavaScript相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/js/入门/" class="nav-link">
  入门
</a></li><li class="dropdown-item"><!----> <a href="/docs/js/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/docs/js/typescript/" class="nav-link">
  typescript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端开发" class="dropdown-title"><span class="title">前端开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端开发" class="mobile-dropdown-title"><span class="title">前端开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/frontend/basic/" class="nav-link">
  前端基础
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/browser/" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/react/" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><a href="/docs/docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/docs/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">
  Blockchain
</a></div><div class="nav-item"><a href="/docs/cryptograph/" class="nav-link">
  密码学
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS" class="dropdown-title"><span class="title">CS</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS" class="mobile-dropdown-title"><span class="title">CS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/cs/computer-architecture/" class="nav-link">
  计算机组成原理
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/operating-system/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/computer-network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/docs/golang/basic/.html" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发工具" class="mobile-dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/vscode/" class="nav-link">
  VSCode
</a></li></ul></div></div><div class="nav-item"><a href="/docs/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/shengzhou1216/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GoLang相关" class="dropdown-title"><span class="title">GoLang相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="GoLang相关" class="mobile-dropdown-title"><span class="title">GoLang相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/golang/basic/" class="nav-link router-link-active">
  GoLang基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java相关" class="dropdown-title"><span class="title">Java相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="Java相关" class="mobile-dropdown-title"><span class="title">Java相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/java/basic/" class="nav-link">
  Java基础
</a></li><li class="dropdown-item"><!----> <a href="/docs/java/jvm/" class="nav-link">
  JVM
</a></li><li class="dropdown-item"><!----> <a href="/docs/java/spring/" class="nav-link">
  Spring相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript相关" class="dropdown-title"><span class="title">JavaScript相关</span> <span class="arrow down"></span></button> <button type="button" aria-label="JavaScript相关" class="mobile-dropdown-title"><span class="title">JavaScript相关</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/js/入门/" class="nav-link">
  入门
</a></li><li class="dropdown-item"><!----> <a href="/docs/js/es6/" class="nav-link">
  es6
</a></li><li class="dropdown-item"><!----> <a href="/docs/js/typescript/" class="nav-link">
  typescript
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端开发" class="dropdown-title"><span class="title">前端开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端开发" class="mobile-dropdown-title"><span class="title">前端开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/frontend/basic/" class="nav-link">
  前端基础
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/browser/" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/docs/frontend/react/" class="nav-link">
  React
</a></li></ul></div></div><div class="nav-item"><a href="/docs/docker/" class="nav-link">
  Docker
</a></div><div class="nav-item"><a href="/docs/linux/" class="nav-link">
  Linux
</a></div><div class="nav-item"><a href="/docs/blockchain/" class="nav-link">
  Blockchain
</a></div><div class="nav-item"><a href="/docs/cryptograph/" class="nav-link">
  密码学
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CS" class="dropdown-title"><span class="title">CS</span> <span class="arrow down"></span></button> <button type="button" aria-label="CS" class="mobile-dropdown-title"><span class="title">CS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/cs/computer-architecture/" class="nav-link">
  计算机组成原理
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/operating-system/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/docs/cs/computer-network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/docs/golang/basic/.html" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发工具" class="dropdown-title"><span class="title">开发工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="开发工具" class="mobile-dropdown-title"><span class="title">开发工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/vscode/" class="nav-link">
  VSCode
</a></li></ul></div></div><div class="nav-item"><a href="/docs/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://github.com/shengzhou1216/docs" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>创建一个Go模块</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#prerequisites" class="sidebar-link">Prerequisites</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#开始编写一个其他人可以使用的模块" class="sidebar-link">开始编写一个其他人可以使用的模块</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#小结" class="sidebar-link">小结</a></li></ul></li><li><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#从其他模块调用你的代码" class="sidebar-link">从其他模块调用你的代码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#小结-2" class="sidebar-link">小结</a></li></ul></li><li><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#返回并处理错误" class="sidebar-link">返回并处理错误</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#小结-3" class="sidebar-link">小结</a></li></ul></li><li><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#返回一个随机问候语" class="sidebar-link">返回一个随机问候语</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#小结-4" class="sidebar-link">小结</a></li></ul></li><li><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#为多个人返回问候语" class="sidebar-link">为多个人返回问候语</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#小结-5" class="sidebar-link">小结</a></li></ul></li><li><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#添加一个测试" class="sidebar-link">添加一个测试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#小结-6" class="sidebar-link">小结</a></li></ul></li><li><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#编译和安装应用程序" class="sidebar-link">编译和安装应用程序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#小结-7" class="sidebar-link">小结</a></li></ul></li><li><a href="/docs/golang/basic/2.%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAGo%E6%A8%A1%E5%9D%97.html#参考" class="sidebar-link">参考</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="创建一个go模块"><a href="#创建一个go模块" class="header-anchor">#</a> 创建一个Go模块</h1> <p>这是此教程第一次介绍Go语言的一些基础特色。如果你刚开始学Go，确保你看过了 <a href="https://golang.org/doc/tutorial/getting-started.html" target="_blank" rel="noopener noreferrer">起步<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 教程，它介绍了go命令，go 模块 和 很简单的Go代码。</p> <p>在本教程中，你将创建两个模块。第一个是一个库，它将被其他库或应用程序导入。第二个是一个调用程序，它将使用第一个模块。</p> <p>本教程的序列包括六个简短的主题，每个主题说明了语言的不同部分。</p> <ol><li>创建一个模块——编写一个小模块，里面的功能可以从另一个模块调用。</li> <li><a href="https://golang.org/doc/tutorial/call-module-code.html" target="_blank" rel="noopener noreferrer">从另一个模块调用你的代码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ——导入并使用你的新模块。</li> <li><a href="https://golang.org/doc/tutorial/handle-errors.html" target="_blank" rel="noopener noreferrer">返回和处理错误<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> —— 增加简单的错误处理。</li> <li><a href="https://golang.org/doc/tutorial/random-greeting.html" target="_blank" rel="noopener noreferrer">返回一个随机的问候语<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> —— 处理切片中的数据（Go的动态大小数组）。</li> <li><a href="https://golang.org/doc/tutorial/greetings-multiple-people.html" target="_blank" rel="noopener noreferrer">返回多人的问候<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ——在Map中存储键/值对。</li> <li><a href="https://golang.org/doc/tutorial/add-a-test.html" target="_blank" rel="noopener noreferrer">添加一个测试<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ——使用Go内置的单元测试功能来测试你的代码。</li> <li><a href="https://golang.org/doc/tutorial/compile-install.html" target="_blank" rel="noopener noreferrer">编译和安装应用程序<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ——在本地编译和安装你的代码。</li></ol> <p><strong>Note:</strong> For other tutorials, see <a href="https://golang.org/doc/tutorial/index.html" target="_blank" rel="noopener noreferrer">Tutorials<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="prerequisites"><a href="#prerequisites" class="header-anchor">#</a> Prerequisites</h2> <ul><li><strong>一些编程经验.</strong> The code here is pretty simple, but it helps to know something about functions, loops, and arrays.</li> <li><strong>一个代码编辑工具.</strong> Any text editor you have will work fine. Most text editors have good support for Go. The most popular are VSCode (free), GoLand (paid), and Vim (free).</li> <li><strong>一个命令行终端.</strong> Go works well using any terminal on Linux and Mac, and on PowerShell or cmd in Windows.</li></ul> <h2 id="开始编写一个其他人可以使用的模块"><a href="#开始编写一个其他人可以使用的模块" class="header-anchor">#</a> 开始编写一个其他人可以使用的模块</h2> <p>首先创建一个<a href="https://golang.org/doc/code.html#Organization" target="_blank" rel="noopener noreferrer">Go模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。在一个模块中，你为一组离散而有用的功能收集成为一个或多个相关的包。例如，你可以创建一个模块，其中包含有做财务分析的功能的包，以便其他编写财务应用程序的人可以使用你的模块。</p> <p>Go代码组成包，包组成模块。包的模块指定了Go运行代码的上下文，包括Go代码的版本 和 它需要的其他模块。</p> <p>当您在模块中添加或改进功能时，您会发布模块的新版本。开发人员在编写调用模块功能的代码时，可以导入模块的更新包，并在投入生产使用前用新版本进行测试。</p> <ol><li><p>Open a command prompt and <code>cd</code> to your home directory.</p> <p>On Linux or Mac:</p> <div class="language- extra-class"><pre class="language-text"><code>cd
</code></pre></div><p>On Windows:</p> <div class="language- extra-class"><pre class="language-text"><code>cd %HOMEPATH%
</code></pre></div></li> <li><p>创建<code>greetings</code>目录用于存放Go模块源代码。在此编写你的模块代码:</p> <div class="language- extra-class"><pre class="language-text"><code>mkdir greetings
cd greetings
</code></pre></div></li> <li><p>使用<a href="https://golang.org/cmd/go/#hdr-Initialize_new_module_in_current_directory" target="_blank" rel="noopener noreferrer"><code>go mod init</code> command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>创建一个<code>go.mod</code> 文件开始你的模块。</p> <p>运行 <code>go mod init</code>命令，给出你的代码所在模块的路径。这里，模块路径使用<code>example.com/greetings</code>——在生产代码中，这将是下载模块的URL。</p> <div class="language-bash extra-class"><pre class="language-bash"><code></code></pre></div></li></ol> <p>$ go mod init example.com/greetings
go: creating new go.mod: module example.com/greetings</p> <div class="language- extra-class"><pre class="language-text"><code>
`go mod init`命令创建了一个`go.mod`文件，它将你的代码标识为一个可能被其他代码使用的模块。你刚刚创建的文件只包括你的模块名称和你的代码所支持的Go版本。但是当你添加依赖关系时 -- 意味着来自其他模块的包 -- `go.mod`文件将列出要使用的特定模块版本。这样可以保持构建的可重复性，并让你直接控制要使用的模块版本。

4. 在你的文本编辑器中，创建一个文件来编写你的代码，并将其称为`greetings.go`。

5. 将以下代码粘贴到你的`greetings.go`文件中并保存文件。

```go
package greetings

import &quot;fmt&quot;

// Hello returns a greeting for the named person.
func Hello(name string) string {
    // Return a greeting that embeds the name in a message.
    message := fmt.Sprintf(&quot;Hi, %v. Welcome!&quot;, name)
    return message
}
</code></pre></div><p>这是你模块的第一段代码。它向任何要求调用的调用者返回一个问候语。你将在下一步编写调用这个函数的代码。</p> <p>在上面的代码中，你:</p> <ul><li><p>声明了一个 <code>greetings</code> 包来收集相关功能.</p></li> <li><p>实现了一个 <code>Hello</code> 函数，返回问候语.</p> <p>这个函数接受一个类型为 &quot;string &quot;的 &quot;name &quot;参数，并返回一个 &quot;string&quot;。在Go中，一个名字以大写字母开头的函数可以被不在同一个包中的函数调用。这在Go中被称为<a href="https://tour.golang.org/basics/3" target="_blank" rel="noopener noreferrer"><em>exported</em> name<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <blockquote><p><strong>如果一个函数的函数名以大写字母开头，那么该函数会被导出。</strong></p></blockquote> <p><img src="/docs/assets/img/image-20210712142954547.6f8bdf47.png" alt="image-20210712142954547"></p></li> <li><p>声明一个<code>message</code>变量来保存你的问候语。</p> <p>在Go中，<code>:=</code>操作符是在一行中<strong>声明和初始化</strong>一个变量的快捷方式（Go使用右边的值来确定变量的类型）。从长计议，你可能会写成这样:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">var</span> message <span class="token builtin">string</span>
message <span class="token operator">=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Hi, %v. Welcome!&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
</code></pre></div></li> <li><p>使用<code>fmt</code>包中的<a href="https://pkg.go.dev/fmt/#Sprintf" target="_blank" rel="noopener noreferrer"><code>Sprintf</code>函数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来创建一个问候信息。第一个参数是一个格式字符串，<code>Sprintf</code>将<code>name</code>参数的值替换为<code>%v</code>格式动词。插入<code>name</code>参数的值就完成了问候文字。</p></li> <li><p>将格式化的问候文字返回给调用者。</p></li></ul> <h3 id="小结"><a href="#小结" class="header-anchor">#</a> 小结</h3> <ul><li><code>go mod init</code> 命令：以当前目录为根目录创建一个模块。 此命令会创建有一个 <code>go.mod</code>文件，其中列出的了此模块中依赖的其他模块</li> <li>如果一个函数的函数名以大写字母开头，那么该函数会被导出，可以被其他模块调用。</li> <li><code>:=</code>  声明并初始化</li> <li><code>fmt</code>格式化字符串——<code>%v</code>可以将替换字符串</li></ul> <h2 id="从其他模块调用你的代码"><a href="#从其他模块调用你的代码" class="header-anchor">#</a> 从其他模块调用你的代码</h2> <p>在<a href="https://golang.org/doc/tutorial/create-module.html" target="_blank" rel="noopener noreferrer">上一节<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中，你创建了一个 &quot;问候 &quot;模块。在本节中，你将编写代码，以使你可以作为应用程序执行，并调用问候模块中的代码。</p> <p>**注：**本主题是多部分教程的一部分，从<a href="https://golang.org/doc/tutorial/create-module.html" target="_blank" rel="noopener noreferrer">创建Go模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>开始。</p> <ol><li><p>在Go模块源码目中创建一个<code>hello</code>目录。在这里写你的调用者。</p> <p>例如，如果你在命令提示符中的当前目录是问候语目录，你可以使用以下命令。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>
<span class="token function">mkdir</span> hello
<span class="token builtin class-name">cd</span> hello
</code></pre></div></li> <li><p>在你的文本编辑器中(在hello目录下)，创建一个文件来写你的代码，并把它叫做<code>hello.go</code>。</p></li> <li><p>编写代码调用<code>Hello</code>函数，然后打印函数的返回值。</p> <p>将以下代码复制到<code>hello.go</code> 中:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>

    <span class="token string">&quot;example.com/greetings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Get a greeting message and print it.</span>
    message <span class="token operator">:=</span> greetings<span class="token punctuation">.</span><span class="token function">Hello</span><span class="token punctuation">(</span><span class="token string">&quot;Gladys&quot;</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在此代码中，你:</p> <ul><li>声明了一个 <code>main</code> 包. 在Go中，作为应用程序执行的代码必须放在主包中。.</li> <li>导入两个包。<code>example.com/greetings</code>和<code>fmt</code>。这样你的代码就可以访问这些包中的函数。导入<code>example.com/greetings</code>(你之前创建的模块中包含的包)使你可以访问<code>Hello</code>函数。你还可以导入<code>fmt</code>，其中有处理输入和输出文本的函数（如向控制台打印文本）。</li> <li>通过调用 <code>greetings</code>包的<code>Hello</code>函数来获取问候语。</li></ul></li> <li><p>为这个hello包创建一个新模块。.</p> <p>在hello目录下的命令行中，运行<code>go mod init</code>命令，给它一个你的代码将在其中的模块名称(这里，只需使用 &quot;hello&quot;)。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go mod init example.com/hello
go: creating new go.mod: module example.com/hello
</code></pre></div></li> <li><p>编辑<code>hello</code>模块，使用未发布的greetings模块。.</p> <p>对于生产使用，你会把你的模块发布在服务器上，无论是在公司内部还是在互联网上，Go命令将从那里下载它们。现在，你需要调整调用者的模块，使它能在你的本地文件系统中找到greetings代码。</p> <p>要做到这一点，对<code>hello</code>模块的go.mod文件做一个小小的改动。</p> <ol><li><p>在hello目录下，打开go.mod文件，把它改成下面的样子，然后保存文件。</p> <div class="language-go extra-class"><pre class="language-go"><code>module example<span class="token punctuation">.</span>com<span class="token operator">/</span>hello

<span class="token keyword">go</span> <span class="token number">1.16</span>

replace example<span class="token punctuation">.</span>com<span class="token operator">/</span>greetings <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>greetings
</code></pre></div><p><strong>这里，<a href="https://golang.org/ref/mod#tmp_15" target="_blank" rel="noopener noreferrer">replace<code>指令</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>告诉Go用你指定的路径替换模块路径(URL<code>example.com/greetings</code>)。在本例中，就是hello目录旁边的greetings目录。</strong></p> <blockquote><p>或利用  <a href="https://golang.org/ref/mod#go-mod-edit" target="_blank" rel="noopener noreferrer"><code>go mod edit</code> command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>  将Go tools 从其模块路径重定向到本地目录</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go mod edit -replace example.com/greetings<span class="token operator">=</span><span class="token punctuation">..</span>/greetings
</code></pre></div></blockquote> <ol><li>在hello目录下，运行<a href="https://golang.org/ref/mod#go-mod-tidy" target="_blank" rel="noopener noreferrer">go mod tidy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>命令来同步 <code>example.com/hello</code>模块的依赖，使Go找到该模块，并将其作为依赖项添加到<code>go.mod</code>文件中。</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go mod tidy
go: found example.com/greetings <span class="token keyword">in</span> example.com/greetings v0.0.0-00010101000000-000000000000
</code></pre></div></li> <li><p>再看go.mod，可以看到<code>go mod tidy</code>所做的改动，包括Go添加的<code>require</code>指令。</p> <div class="language- extra-class"><pre class="language-text"><code>module example.com/hello

go 1.16

replace example.com/greetings =&gt; ../greetings

require example.com/greetings v0.0.0-00010101000000-000000000000
</code></pre></div><p>为了构建该模块，Go在./greetings目录下找到了本地代码，然后添加了一个<a href="https://golang.org/ref/mod#tmp_13" target="_blank" rel="noopener noreferrer"><code>require</code>指令<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来指定<code>hello</code>依赖(需要)<code>example.com/greetings</code>。当你在hello.go中导入 &quot;greetings &quot;包（包含在greetings模块中）时，你创建了这个依赖关系。<code>replace</code>指令告诉Go在哪里可以找到<code>greetings</code>模块，因为它还没有发布。</p> <p>要引用一个已发布的模块，<code>go.mod</code>文件将省略 <code>replace</code>指令，而使用<code>require</code>指令，并在末尾标注版本号。</p> <div class="language-go extra-class"><pre class="language-go"><code>require example<span class="token punctuation">.</span>com<span class="token operator">/</span>greetings v1<span class="token punctuation">.</span><span class="token number">1.0</span>
</code></pre></div></li></ol></li> <li><p>在hello目录下，运行代码，以确定其是否能工作</p> <div class="language-go extra-class"><pre class="language-go"><code>$ <span class="token punctuation">.</span><span class="token operator">/</span>hello
Hi<span class="token punctuation">,</span> Gladys<span class="token punctuation">.</span> Welcome<span class="token operator">!</span>
</code></pre></div></li></ol> <p>恭喜你！你已经写了两个功能模块。在教程的<a href="https://golang.org/doc/tutorial/handle-errors.html" target="_blank" rel="noopener noreferrer">下一个主题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中，你将添加一些错误处理。</p> <h3 id="小结-2"><a href="#小结-2" class="header-anchor">#</a> 小结</h3> <ul><li><p><code>import</code>可以导入多个包，其一般形式为：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
 	<span class="token string">&quot;example.com/greetings&quot;</span>
<span class="token punctuation">)</span>
</code></pre></div></li> <li><p><code>replace</code>命令可以将模块路径替换为指定的路径，这样就可以引用本地模块了。其一般形如下:</p> <div class="language-go extra-class"><pre class="language-go"><code>replace example<span class="token punctuation">.</span>com<span class="token operator">/</span>greetings <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>greetings
</code></pre></div></li> <li><p><code>go mod tidy</code>命令可以同步<code>go.mod</code>文件中的依赖</p></li></ul> <h2 id="返回并处理错误"><a href="#返回并处理错误" class="header-anchor">#</a> 返回并处理错误</h2> <p>处理错误是健壮代码的一个基本特征。在本节中，你将添加一点代码，从greetings模块返回一个错误，然后在调用者中处理它。</p> <ol><li><p>在<code>greetings/greetings.go</code>中，添加以下代码。</p> <p>如果不知道要问候谁，发回问候就没有意义了。如果名字是空的，就返回一个错误给调用者。将下面的代码复制到<code>greetings.go</code>中并保存文件。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> greetings

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;errors&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// Hello returns a greeting for the named person.</span>
<span class="token keyword">func</span> <span class="token function">Hello</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If no name was given, return an error with a message.</span>
    <span class="token keyword">if</span> name <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;empty name&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// If a name was received, return a value that embeds the name </span>
    <span class="token comment">// in a greeting message.</span>
    message <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;Hi, %v. Welcome!&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
    <span class="token keyword">return</span> message<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在此代码中，你:</p> <ul><li>修改函数，使其返回两个值：一个<code>string</code>和一个<code>error</code>。你的调用者将检查第二个值，看看是否发生了错误。(任何Go函数都可以<a href="https://golang.org/doc/effective_go.html#multiple-returns" target="_blank" rel="noopener noreferrer">返回多个值<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。)</li> <li>导入Go标准库<code>errors</code>包，这样你就可以使用它的<a href="https://golang.org/pkg/errors/#example_New" target="_blank" rel="noopener noreferrer"><code>errors.New</code>函数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</li> <li>添加一个<code>if</code>语句来检查是否有无效的请求(名称应该是一个空字符串)，如果请求无效则返回一个错误。<code>errors.New</code>函数返回一个<code>error</code>，里面有你的信息。</li> <li>在成功返回中加入<code>nil</code>（意为没有错误）作为第二个值。这样，调用者就可以看到函数成功了。</li></ul></li> <li><p>在你的<code>hello/hello.go</code>文件中，处理现在由<code>Hello</code>函数返回的错误，以及非错误值。</p> <p>将以下代码粘贴到<code>hello.go</code>中。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;log&quot;</span>

    <span class="token string">&quot;example.com/greetings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Set properties of the predefined Logger, including</span>
    <span class="token comment">// the log entry prefix and a flag to disable printing</span>
    <span class="token comment">// the time, source file, and line number.</span>
    log<span class="token punctuation">.</span><span class="token function">SetPrefix</span><span class="token punctuation">(</span><span class="token string">&quot;greetings: &quot;</span><span class="token punctuation">)</span>
    log<span class="token punctuation">.</span><span class="token function">SetFlags</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token comment">// Request a greeting message.</span>
    message<span class="token punctuation">,</span> err <span class="token operator">:=</span> greetings<span class="token punctuation">.</span><span class="token function">Hello</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// If an error was returned, print it to the console and</span>
    <span class="token comment">// exit the program.</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// If no error was returned, print the returned message</span>
    <span class="token comment">// to the console.</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在此代码中，你:</p> <ul><li>配置<a href="https://golang.org/pkg/log/" target="_blank" rel="noopener noreferrer"><code>log</code>包<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>在其日志消息的开头打印命令名(&quot;greetings：&quot;)，不含时间戳或源文件信息。</li> <li>将包括 &quot;error &quot;在内的两个 &quot;Hello &quot;返回值分配给变量。</li> <li>将<code>Hello</code>参数中Gladys的名字改为空字符串，这样你就可以尝试一下你的错误处理代码。</li> <li>寻找一个非零的<code>error</code>值。在这种情况下继续下去是没有意义的。</li> <li>使用标准库的<code>log包</code>中的函数来输出错误信息。如果你得到一个错误，你使用<code>log</code>包的<a href="https://pkg.go.dev/log?tab=doc#Fatal" target="_blank" rel="noopener noreferrer"><code>Fatal</code>函数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来打印错误并<strong>停止程序</strong>。</li></ul></li> <li><p>在hello目录下的命令行，运行<code>hello.go</code>来确认代码是否有效。</p> <p>现在你传入的是一个空名字，你会得到一个错误。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go run <span class="token builtin class-name">.</span>
greetings: empty name
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
</code></pre></div></li></ol> <p>这基本上是Go中错误处理的工作方式。把一个错误作为一个值返回，这样调用者就可以检查它。这很简单。在本教程的<a href="https://golang.org/doc/tutorial/random-greeting.html" target="_blank" rel="noopener noreferrer">下一主题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中，你将使用Go切片来返回一个随机选择的问候语。</p> <h3 id="小结-3"><a href="#小结-3" class="header-anchor">#</a> 小结</h3> <ul><li><p>如何返回错误： 在方法的返回值中返回错误</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">Hello</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><p>错误定义在<code>errors</code>包中，创建一个error可以使用 <code>errors.New(&quot;empty name&quot;)</code></p></li> <li><p>如何处理错误，一般形式为:</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="返回一个随机问候语"><a href="#返回一个随机问候语" class="header-anchor">#</a> 返回一个随机问候语</h2> <p>在本节中，您将修改您的代码，使其不再每次返回一个单一的问候语，而是返回几个预定义的问候语中的一个。</p> <p>要做到这一点，你将使用一个Go slice。一个 <a href="https://blog.golang.org/slices-intro" target="_blank" rel="noopener noreferrer"><em>slice</em><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 就像一个数组，只不过它的大小是随着你添加和删除项目而动态调整的。它是 Go 中最有用的类型之一。您将添加一个小片来包含三条问候信息，然后让您的代码随机返回其中一条信息。</p> <ol><li><p>在<code>greetings/greetings.go</code>中，修改你的代码，使其看起来像下面这样。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> greetings

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;errors&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;math/rand&quot;</span>
    <span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// Hello returns a greeting for the named person.</span>
<span class="token keyword">func</span> <span class="token function">Hello</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If no name was given, return an error with a message.</span>
    <span class="token keyword">if</span> name <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;empty name&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Create a message using a random format.</span>
    message <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token function">randomFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
    <span class="token keyword">return</span> message<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// init sets initial values for variables used in the function.</span>
<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rand<span class="token punctuation">.</span><span class="token function">Seed</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UnixNano</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// randomFormat returns one of a set of greeting messages. The returned</span>
<span class="token comment">// message is selected at random.</span>
<span class="token keyword">func</span> <span class="token function">randomFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token comment">// A slice of message formats.</span>
    formats <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;Hi, %v. Welcome!&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Great to see you, %v!&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Hail, %v! Well met!&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Return a randomly selected message format by specifying</span>
    <span class="token comment">// a random index for the slice of formats.</span>
    <span class="token keyword">return</span> formats<span class="token punctuation">[</span>rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>formats<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在此代码中，你:</p> <ul><li>增加一个<code>randomFormat</code>函数，为问候信息返回一个随机选择的格式。请注意，<strong><code>randomFormat</code>以小写字母开头，使得它只能被自己包中的代码访问（换句话说，它不能被导出）。</strong></li> <li>在<code>randomFormat</code>中，声明一个<code>formats</code>分片，有三种消息格式。当声明一个分片时，你在括号中省略它的大小，像这样。<code>[]string</code>. 这告诉Go，分片的底层数组可以动态调整大小。</li> <li>使用<a href="https://golang.org/pkg/math/rand/" target="_blank" rel="noopener noreferrer"><code>math/rand</code>包<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>生成一个随机数，用于从切片中选择一个项目。</li> <li>增加一个<a href="https://golang.org/doc/effective_go.html#init" target="_blank" rel="noopener noreferrer"><code>init</code>函数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，为<code>rand</code>包添加当前时间的种子。<strong>在全局变量初始化后，Go会在程序启动时自动执行<code>init</code>函数。</strong></li> <li>在 <code>Hello</code>中，调用<code>randomFormat</code>函数来获取你要返回的消息的格式，然后使用格式和 <code>name</code>值一起创建消息。</li> <li>像之前那样返回信息（或错误）。</li></ul></li> <li><p>在<code>hello/hello.go</code>中，将其中代码更改为以下内容</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;log&quot;</span>

    <span class="token string">&quot;example.com/greetings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Set properties of the predefined Logger, including</span>
    <span class="token comment">// the log entry prefix and a flag to disable printing</span>
    <span class="token comment">// the time, source file, and line number.</span>
    log<span class="token punctuation">.</span><span class="token function">SetPrefix</span><span class="token punctuation">(</span><span class="token string">&quot;greetings: &quot;</span><span class="token punctuation">)</span>
    log<span class="token punctuation">.</span><span class="token function">SetFlags</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token comment">// Request a greeting message.</span>
    message<span class="token punctuation">,</span> err <span class="token operator">:=</span> greetings<span class="token punctuation">.</span><span class="token function">Hello</span><span class="token punctuation">(</span><span class="token string">&quot;Gladys&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// If an error was returned, print it to the console and</span>
    <span class="token comment">// exit the program.</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// If no error was returned, print the returned message</span>
    <span class="token comment">// to the console.</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>在命令行，切换到hello目录下，然后运行<code>hello.go</code>，确认代码有效。多次运行，注意问候语的变化</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go run <span class="token builtin class-name">.</span>
Great to see you, Gladys<span class="token operator">!</span>

$ go run <span class="token builtin class-name">.</span>
Hi, Gladys. Welcome<span class="token operator">!</span>

$ go run <span class="token builtin class-name">.</span>
Hail, Gladys<span class="token operator">!</span> Well met<span class="token operator">!</span>
</code></pre></div></li></ol> <p>这就是对Go 分片的介绍。为了让这种类型得到更多的使用，你将使用一个分片来向多个人打招呼。这在教程的<a href="https://golang.org/doc/tutorial/greetings-multiple-people.html" target="_blank" rel="noopener noreferrer">下一主题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中。</p> <h3 id="小结-4"><a href="#小结-4" class="header-anchor">#</a> 小结</h3> <ul><li><p>以小写字母开头的方法，只能被自己包中的代码访问（换句话说，它不能被导出）</p></li> <li><p>声明并初始化一个slice：</p> <div class="language-go extra-class"><pre class="language-go"><code>formats <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
    <span class="token string">&quot;aaa&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;bbb&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>在全局变量初始化后，Go会在程序启动时自动执行<code>init</code>函数。</p></li></ul> <h2 id="为多个人返回问候语"><a href="#为多个人返回问候语" class="header-anchor">#</a> 为多个人返回问候语</h2> <p>在你对模块代码的最后一次修改中，你将添加支持在一个请求中获取多人的问候。换句话说，你将处理一个多值输入和对值与多值输出。</p> <p>要做到这一点，你需要向一个函数传递一组名字，该函数可以为每个名字返回一个问候语。将<code>Hello</code>函数的参数从一个名字改为一组名字会改变函数的签名。如果你已经发布了<code>greetings</code>模块，而用户已经编写了调用<code>Hello</code>的代码，这种改变会破坏他们的程序。在这种情况下，更好的选择是给新功能起一个新的名字。</p> <p>在本教程将要添加的最后一段代码中，更新代码，就像你已经发布了一个 <code>greetings</code>模块的版本一样。不要改变<code>Hello</code>函数，而是添加一个新的函数<code>Hellos</code>，它接受一组名字。然后，为了简单起见，让新函数调用现有函数。将这两个函数保留在包中，为现有的调用者（或未来只需要一个问候语的调用者）留下原来的函数，为想要扩展功能的调用者增加一个新函数。</p> <ol><li><p>在greetings/greetings.go中，修改你的代码，使其看起来像下面这样。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> greetings

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;errors&quot;</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;math/rand&quot;</span>
    <span class="token string">&quot;time&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// Hello returns a greeting for the named person.</span>
<span class="token keyword">func</span> <span class="token function">Hello</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If no name was given, return an error with a message.</span>
    <span class="token keyword">if</span> name <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;empty name&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Create a message using a random format.</span>
    message <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token function">randomFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
    <span class="token keyword">return</span> message<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// Hellos returns a map that associates each of the named people</span>
<span class="token comment">// with a greeting message.</span>
<span class="token keyword">func</span> <span class="token function">Hellos</span><span class="token punctuation">(</span>names <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// A map to associate names with messages.</span>
    messages <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">)</span>
    <span class="token comment">// Loop through the received slice of names, calling</span>
    <span class="token comment">// the Hello function to get a message for each name.</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> name <span class="token operator">:=</span> <span class="token keyword">range</span> names <span class="token punctuation">{</span>
        message<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">Hello</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
        <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> err
        <span class="token punctuation">}</span>
        <span class="token comment">// In the map, associate the retrieved message with </span>
        <span class="token comment">// the name.</span>
        messages<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> message
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> messages<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// Init sets initial values for variables used in the function.</span>
<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rand<span class="token punctuation">.</span><span class="token function">Seed</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">UnixNano</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// randomFormat returns one of a set of greeting messages. The returned</span>
<span class="token comment">// message is selected at random.</span>
<span class="token keyword">func</span> <span class="token function">randomFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
    <span class="token comment">// A slice of message formats.</span>
    formats <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;Hi, %v. Welcome!&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Great to see you, %v!&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;Hail, %v! Well met!&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Return one of the message formats selected at random.</span>
    <span class="token keyword">return</span> formats<span class="token punctuation">[</span>rand<span class="token punctuation">.</span><span class="token function">Intn</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>formats<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在此代码中，你:</p> <ul><li>增加一个 <code>Hellos</code>函数，其参数是一个<em>names</em>的切片，而不是一个name。另外，你把它的一个返回类型从 <code>string</code>改为<code>map</code>，这样你就可以返回映射到问候信息的名字。</li> <li>让新的Hellos函数调用现有的Hello函数。这样，两个函数都会留在原地。</li> <li>创建一个<code>messages</code><a href="https://blog.golang.org/maps" target="_blank" rel="noopener noreferrer">map<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，将每个接收到的名字（作为键）与生成的消息（作为值）关联起来。在Go中，你用以下语法初始化一个map。<strong>make(map[key-type]<em>value-type</em>)</strong>。你让<code>Hellos</code>函数把这个地图返回给调用者。</li> <li>循环检查你的函数收到的名称，检查每个名称是否有一个非空值，然后为每个名称关联一个消息。在这个 &quot;for &quot;循环中，&quot;range &quot;返回两个值：循环中当前项的索引和项的值的副本。你不需要索引，所以你使用Go<a href="https://golang.org/doc/effective_go.html#blank" target="_blank" rel="noopener noreferrer">空白标识符（下划线）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>来忽略它。</li></ul></li> <li><p>在你的<code>hello/hello.go</code>调用代码中，传递一片names，然后打印你得到的<code>names/essages map</code>的内容。</p> <p>在<code>hello.go</code>中，修改你的代码，使其看起来像下面。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;log&quot;</span>

    <span class="token string">&quot;example.com/greetings&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Set properties of the predefined Logger, including</span>
    <span class="token comment">// the log entry prefix and a flag to disable printing</span>
    <span class="token comment">// the time, source file, and line number.</span>
    log<span class="token punctuation">.</span><span class="token function">SetPrefix</span><span class="token punctuation">(</span><span class="token string">&quot;greetings: &quot;</span><span class="token punctuation">)</span>
    log<span class="token punctuation">.</span><span class="token function">SetFlags</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token comment">// A slice of names.</span>
    names <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;Gladys&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Samantha&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Darrin&quot;</span><span class="token punctuation">}</span>

    <span class="token comment">// Request greeting messages for the names.</span>
    messages<span class="token punctuation">,</span> err <span class="token operator">:=</span> greetings<span class="token punctuation">.</span><span class="token function">Hellos</span><span class="token punctuation">(</span>names<span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// If no error was returned, print the returned map of</span>
    <span class="token comment">// messages to the console.</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有了这些变化，你:</p> <ul><li>创建一个 &quot;names &quot;变量，作为一个分片类型，容纳三个名字。</li> <li>将<code>names</code>变量作为参数传递给<code>Hellos</code>函数。</li></ul></li> <li><p>在命令行，切换到<code>hello/hello.go</code>的目录下，然后运行<code>hello.go</code>来确认代码是否有效。</p> <p>输出应该是一个将名字和消息关联起来的地图的字符串表示，就像下面这样。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go run <span class="token builtin class-name">.</span>
map<span class="token punctuation">[</span>Darrin:Hail, Darrin<span class="token operator">!</span> Well met<span class="token operator">!</span> Gladys:Hi, Gladys. Welcome<span class="token operator">!</span> Samantha:Hail, Samantha<span class="token operator">!</span> Well met<span class="token operator">!</span><span class="token punctuation">]</span>
</code></pre></div></li></ol> <p>本主题介绍了表示名称/值对的Map。它还介绍了<a href="https://blog.golang.org/module-compatibility" target="_blank" rel="noopener noreferrer">保留向后兼容性<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的想法，即通过为模块中的新功能或改变的功能实现一个新功能。在本教程的<a href="https://golang.org/doc/tutorial/add-a-test.html" target="_blank" rel="noopener noreferrer">下一个主题<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中，你将使用内置功能为你的代码创建一个单元测试。</p> <h3 id="小结-5"><a href="#小结-5" class="header-anchor">#</a> 小结</h3> <ul><li><p>定义map的一般形式</p> <div class="language-go extra-class"><pre class="language-go"><code># <span class="token keyword">map</span><span class="token punctuation">[</span>key<span class="token operator">-</span><span class="token keyword">type</span><span class="token punctuation">]</span><span class="token punctuation">(</span>value<span class="token operator">-</span><span class="token keyword">type</span><span class="token punctuation">)</span>
<span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span>
</code></pre></div></li> <li><p>创建一个map</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span>key<span class="token operator">-</span><span class="token keyword">type</span><span class="token punctuation">]</span><span class="token punctuation">(</span>value<span class="token operator">-</span><span class="token keyword">type</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>迭代map</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span>key <span class="token operator">:=</span> <span class="token keyword">range</span> somemap <span class="token punctuation">{</span>
    
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h2 id="添加一个测试"><a href="#添加一个测试" class="header-anchor">#</a> 添加一个测试</h2> <p>现在你已经把你的代码稳定下来了（顺便说一句，做得很好），添加一个测试。在开发过程中测试你的代码可以暴露出错误，这些错误会在你进行修改时发现。在这个主题中，你为Hello函数添加了一个测试。</p> <p>Go对单元测试的内置支持使您更容易进行测试。具体来说，使用命名惯例、Go的 <code>testing</code>包和 <code>go test</code>命令，你可以快速编写和执行测试。</p> <ol><li><p>在<code>greetings</code>目录下，创建一个名为<code>greetings_test.go</code>的文件。</p> <p>以<code>_test.go</code>作为文件名的结尾，告诉<code>go test</code>命令这个文件包含测试函数。</p></li> <li><p>在<code>greetings_test.go</code>中，粘贴以下代码并保存文件。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> greetings

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;testing&quot;</span>
    <span class="token string">&quot;regexp&quot;</span>
<span class="token punctuation">)</span>

<span class="token comment">// TestHelloName calls greetings.Hello with a name, checking </span>
<span class="token comment">// for a valid return value.</span>
<span class="token keyword">func</span> <span class="token function">TestHelloName</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    name <span class="token operator">:=</span> <span class="token string">&quot;Gladys&quot;</span>
    want <span class="token operator">:=</span> regexp<span class="token punctuation">.</span><span class="token function">MustCompile</span><span class="token punctuation">(</span><span class="token string">`\b`</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">`\b`</span><span class="token punctuation">)</span>
    msg<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">Hello</span><span class="token punctuation">(</span><span class="token string">&quot;Gladys&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token operator">!</span>want<span class="token punctuation">.</span><span class="token function">MatchString</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">||</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        t<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">`Hello(&quot;Gladys&quot;) = %q, %v, want match for %#q, nil`</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> err<span class="token punctuation">,</span> want<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// TestHelloEmpty calls greetings.Hello with an empty string, </span>
<span class="token comment">// checking for an error.</span>
<span class="token keyword">func</span> <span class="token function">TestHelloEmpty</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    msg<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">Hello</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> msg <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token operator">||</span> err <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        t<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">`Hello(&quot;&quot;) = %q, %v, want &quot;&quot;, error`</span><span class="token punctuation">,</span> msg<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在此代码中，你:</p> <ul><li>在与你要测试的代码相同的包中实现测试函数。</li> <li>创建了2个测试函数去测试<code>greetings.Hello</code>函数。测试函数名名为<em>Test<strong>Name</strong></em>，***Name***指定要测试的函数。测试函数接受<a href="https://golang.org/pkg/testing/" target="_blank" rel="noopener noreferrer"><code>testing</code> package's<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <code>testing.T</code>做为一个参数。你可以使用这个参数的方法用于测试的报告或记录日志。</li> <li>实现了2个测试:
<ul><li><code>TestHelloName</code> calls the <code>Hello</code> function, passing a <code>name</code> value with which the function should be able to return a valid response message. If the call returns an error or an unexpected response message (one that doesn't include the name you passed in), you use the <code>t</code> parameter's <code>Fatalf</code> method to print a message to the console and end execution.</li> <li><code>TestHelloEmpty</code> calls the <code>Hello</code> function with an empty string. This test is designed to confirm that your error handling works. If the call returns a non-empty string or no error, you use the <code>t</code> parameter's <a href="https://golang.org/pkg/testing/#T.Fatalf" target="_blank" rel="noopener noreferrer"><code>Fatalf</code> method<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to print a message to the console and end execution.</li></ul></li></ul></li> <li><p>在命令行中的greetings目录中，执行<code>go test</code>命令执行测试。</p> <p><a href="https://golang.org/cmd/go/#hdr-Test_packages" target="_blank" rel="noopener noreferrer">go test<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>命令执行测试文件（名称以<code>_test.go</code>结尾）中的测试函数（名称以<code>Test</code>开头）。可以添加<code>-v</code>标记来查看详细输出。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go <span class="token builtin class-name">test</span>
PASS
ok      example.com/greetings   <span class="token number">0</span>.364s

$ go <span class="token builtin class-name">test</span> -v
   <span class="token operator">==</span><span class="token operator">=</span> RUN   TestHelloName
--- PASS: TestHelloName <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
   <span class="token operator">==</span><span class="token operator">=</span> RUN   TestHelloEmpty
--- PASS: TestHelloEmpty <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
   PASS
   ok      example.com/greetings   <span class="token number">0</span>.372s
</code></pre></div></li> <li><p>破话 <code>greetings.Hello</code> 函数来看以下测试失败的情况.</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// Hello returns a greeting for the named person.</span>
<span class="token keyword">func</span> <span class="token function">Hello</span><span class="token punctuation">(</span>name <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If no name was given, return an error with a message.</span>
    <span class="token keyword">if</span> name <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;empty name&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Create a message using a random format.</span>
    <span class="token comment">// message := fmt.Sprintf(randomFormat(), name)</span>
    message <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprint</span><span class="token punctuation">(</span><span class="token function">randomFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> message<span class="token punctuation">,</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>在命令行运行， <code>go test</code>执行测试</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go <span class="token builtin class-name">test</span>
--- FAIL: TestHelloName <span class="token punctuation">(</span><span class="token number">0</span>.00s<span class="token punctuation">)</span>
    greetings_test.go:15: Hello<span class="token punctuation">(</span><span class="token string">&quot;Gladys&quot;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">&quot;Hail, %v! Well met!&quot;</span>, <span class="token operator">&lt;</span>nil<span class="token operator">&gt;</span>, want match <span class="token keyword">for</span> <span class="token variable"><span class="token variable">`</span><span class="token punctuation">\</span>bGladys<span class="token punctuation">\</span>b<span class="token variable">`</span></span>, nil
FAIL
<span class="token builtin class-name">exit</span> status <span class="token number">1</span>
FAIL    example.com/greetings   <span class="token number">0</span>.182s
</code></pre></div></li></ol> <h3 id="小结-6"><a href="#小结-6" class="header-anchor">#</a> 小结</h3> <ul><li>以<code>_test.go</code>作为文件名的结尾，告诉<code>go test</code>命令这个文件包含测试函数。</li> <li>测试函数接受<a href="https://golang.org/pkg/testing/" target="_blank" rel="noopener noreferrer"><code>testing</code> package's<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <code>testing.T</code>做为一个参数。你可以使用这个参数的方法用于测试的报告或记录日志。</li></ul> <h2 id="编译和安装应用程序"><a href="#编译和安装应用程序" class="header-anchor">#</a> 编译和安装应用程序</h2> <p>在这最后一个主题中，你将学习几个新的go命令。虽然<code>go run</code>命令是一个有用的快捷方式，当你频繁地进行修改时，它可以编译和运行一个程序，但它不会生成一个二进制的可执行文件。</p> <p>本主题介绍了两个额外的指令，用于构建代码:</p> <ul><li><a href="https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies" target="_blank" rel="noopener noreferrer"><code>go build</code> command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> : 编译包及其依赖，但是不会安装编译后的结果</li> <li><a href="https://golang.org/ref/mod#go-install" target="_blank" rel="noopener noreferrer"><code>go install</code> command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> : 编译并安装包</li></ul> <p>1.在命令行中，切换到<code>hello</code>目录，运行<code>go build</code>命令，将代码编译为可执行的二进制文件</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go build
</code></pre></div><p>2.在命令行中，切换到<code>hello</code>目录,运行编译生成的<code>hello</code>命令，确认代码工作正常</p> <p>注意，编译后的结果取决于你的系统:</p> <ul><li><p>在Linux 或 Mac上</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ ./hello
map<span class="token punctuation">[</span>Darrin:Great to see you, Darrin<span class="token operator">!</span> Gladys:Hail, Gladys<span class="token operator">!</span> Well met<span class="token operator">!</span> Samantha:Hail, Samantha<span class="token operator">!</span> Well met<span class="token operator">!</span><span class="token punctuation">]</span>
</code></pre></div></li> <li><p>在Window上</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ hello.exe
map<span class="token punctuation">[</span>Darrin:Great to see you, Darrin<span class="token operator">!</span> Gladys:Hail, Gladys<span class="token operator">!</span> Well met<span class="token operator">!</span> Samantha:Hail, Samantha<span class="token operator">!</span> Well met<span class="token operator">!</span><span class="token punctuation">]</span>
</code></pre></div></li></ul> <p>你已经将应用编译成了可执行文件。但是要正确运行该文件，你要么需要在正确的目录中运行该文件，要么需要指定可执行文件的路径。</p> <p>接下来，你会安装可执行文件，这样不用指定文件的路径就能够运行该文件了。</p> <ol start="3"><li><p>找到Go安装路径，go 命令会将当前包安装在此路径下</p> <p>可以运行<a href="https://golang.org/cmd/go/#hdr-List_packages_or_modules" target="_blank" rel="noopener noreferrer"><code>go list</code> command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 命令查询Go的安装路径</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go list -f <span class="token string">'{{.Target}}'</span>
</code></pre></div><p>例如，命令行可能输出 <code>/home/gopher/bin/hello</code>, 这意味着二进制文件会被安装到 <code>/home/gopher/bin</code>中。下一步汇总会用到此目录</p></li> <li><p>将Go安装目录添加到系统的shell目录中</p></li></ol> <p>这样，你就可以运行可执行程序而不用指定可执行程序的位置。</p> <ul><li><p>在Linux 或 Mac,运行以下命令:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token environment constant">$PATH</span>:/path/to/your/install/directory
</code></pre></div></li> <li><p>在Windows上，运行以下命令:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">set</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>%<span class="token environment constant">PATH</span>%<span class="token punctuation">;</span>C:<span class="token punctuation">\</span>path<span class="token punctuation">\</span>to<span class="token punctuation">\</span>your<span class="token punctuation">\</span>install<span class="token punctuation">\</span>directory
</code></pre></div></li></ul> <p>最为一种替代方案，你已经有一个像<code>$HOME/bin</code>这样的目录在shell路径中，你想安装Go程序到此路径，你可以使用<a href="https://golang.org/cmd/go/#hdr-Print_Go_environment_information" target="_blank" rel="noopener noreferrer"><code>go env</code> 命令<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>通过设置GOBIN变量改变安装目标。</p> <div class="language-bash extra-class"><pre class="language-bash"><code>go <span class="token function">env</span> -w <span class="token assign-left variable">GOBIN</span><span class="token operator">=</span>/path/to/your/bin
</code></pre></div><p>或</p> <div class="language-bash extra-class"><pre class="language-bash"><code>go <span class="token function">env</span> -w <span class="token assign-left variable">GOBIN</span><span class="token operator">=</span>C:<span class="token punctuation">\</span>path<span class="token punctuation">\</span>to<span class="token punctuation">\</span>your<span class="token punctuation">\</span>bin
</code></pre></div><ol start="5"><li>一旦你已经更新了shell 路径，运行<code>go install</code>命令去编译并安装包:</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>$ go <span class="token function">install</span>
</code></pre></div><ol start="6"><li>简单地输入名称即可运行你的程序</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>$ hello
map<span class="token punctuation">[</span>Darrin:Hail, Darrin<span class="token operator">!</span> Well met<span class="token operator">!</span> Gladys:Great to see you, Gladys<span class="token operator">!</span> Samantha:Hail, Samantha<span class="token operator">!</span> Well met<span class="token operator">!</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="小结-7"><a href="#小结-7" class="header-anchor">#</a> 小结</h3> <ul><li><a href="https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies" target="_blank" rel="noopener noreferrer"><code>go build</code> command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> : 编译包及其依赖，但是不会安装编译后的结果</li> <li><a href="https://golang.org/ref/mod#go-install" target="_blank" rel="noopener noreferrer"><code>go install</code> command<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> : 编译并安装包</li></ul> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <p><a href="https://golang.org/doc/tutorial/create-module" target="_blank" rel="noopener noreferrer">Tutorial: Create a Go module<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后一次更新于:</span> <span class="time">7/23/2021, 11:37:23 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/docs/assets/js/app.01c93764.js" defer></script><script src="/docs/assets/js/2.2d8514e9.js" defer></script><script src="/docs/assets/js/14.0d56bfa0.js" defer></script>
  </body>
</html>
